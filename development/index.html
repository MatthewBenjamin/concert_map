<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width,initial-scale=1">
        <link href="css/style.css" rel="stylesheet">
        <title>Concert Map</title>
    </head>

    <body>
        <!-- GOOGLE MAP -->
        <div class="map-canvas" data-bind="googlemap: { mapBounds: mapBounds() }"></div>

        <!-- INFO WINDOW CONTENT -->
        <div class="info-window-container" style="display: none;">
            <info-window></info-window>
        </div>

        <!-- MENU TOGGLE -->
        <a class="menu-toggle clickable" data-bind="click: function() { toggleMenu() }, css: { open: showMenu() }">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M2 6h20v3H2zm0 5h20v3H2zm0 5h20v3H2z"/>
          </svg>
        </a>

        <!-- EVENT SEARCH -->
        <input class="menu-interface event-search search-box" data-bind="hasFocus: searchBarFocus, textInput: searchInput, css: { open: showMenu() }" placeholder="search concerts">

        <!-- ASK IF USER WANTS LAST.FM ARTIST INFO -->
        <!-- ko if: askForArtistInfo() -->
        <!-- ko template: { name: 'request-info' } --><!-- /ko -->
        <script type="text/html" id="request-info">
            <div class="request-artist-info">
                <h4>Want better search results?</h4>
                <p>If you choose to request info about each artist from Last.fm, you'll be able to search events by detailed info about the artists, such as genre.</p>
                <p>Right now you can only search events by artists' names and venues' names and addresses.</p>
                <p> Note: Last.fm info usually loads quickly, but may be slow depending on Last.fm's servers</p>
                <div>
                    <button class="clickable" data-bind="click: function() { requestAllArtistInfo(true); dontAsk(true);}">Yes</button><button class="clickable" data-bind="click: function() { manualToggle(false); }">No</button><button class="clickable" data-bind="click: function() { dontAsk(true); }">Don't Ask Again</button>
                </div>
            </div>
        </script>
        <!-- /ko -->

        <!-- LOCATION SEARCH -->
        <input class="location-search menu-interface search-box" data-bind="value: currentAddress, css: { open: showMenu() }">

        <!-- INFO LIST TOGGLE -->
        <div class="list-toggle menu-interface" data-bind="css: { open: showMenu() }">
            <button class="list-button clickable" data-bind="css: { pressed: listEvents() }, click: function () { showEvents(); }">EVENTS</button><button class="list-button clickable" data-bind="css: { pressed: listVenues() }, click: function () { showVenues(); }">VENUES</button>
            <button class="info-button clickable" data-bind="css: { pressed: extraInfoBoolean() }, click: toggleExtraInfo">SHOW INFO POP-UP</button>
        </div>

        <div class="menu-interface list-container" data-bind="css: { open: showMenu() }">
            <!-- TODO: no params? seems to be operating from $root/parent context.. -->
            <status-messages></status-messages>

            <!-- EVENT LIST -->
            <concerts-list params="
                mapCenter: mapCenter,
                concerts: concerts,
                concertsStatus: concertsStatus
            "></concerts-list>

            <!-- VENUE LIST -->
            <venues-list params="
                concerts: concerts,
                concertVenues: concertVenues
            "></venues-list>

        </div>

        <!-- EXTRA INFO DISPLAY -->
        <div class="extra-info" data-bind="css: { open: showExtraInfo() }">
            <a class="close-button clickable" data-bind="click: function() { closeExtraInfo(); }">&#10006</a>

            <!-- EVENT INFO -->
            <current-event params="
                currentEvent: currentEvent
            "></current-event>

            <!-- VENUE INFO -->
            <current-venue params="
                currentVenue: currentVenue
            "></current-venue>

            <!-- ARTIST INFO -->
            <current-artist params="
                currentArtist: currentArtist
            "></current-artist>

        <script data-main="js/init" src="js/require.js"></script>
        <script src="js/main.js"></script>
    </body>
</html>