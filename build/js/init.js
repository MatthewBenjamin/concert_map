/** @license
 * RequireJS plugin for async dependency load like JSONP and Google Maps
 * Author: Miller Medeiros
 * Version: 0.1.2 (2014/02/24)
 * Released under the MIT license
 */

/**
 * @license text 2.0.15 Copyright jQuery Foundation and other contributors.
 * Released under MIT license, http://github.com/requirejs/text/LICENSE
 */

define("utils",[],function(){function e(e,t){for(var n=0;n<t.length;n++)if(e===t[n].id)return n;return-1}var t={};return t.buildVenues=function(t,n){var a=[];"undefined"==typeof n&&(n=a);for(var s,o,r=0;r<t.length;r++)s=e(t[r].venue.id,a),o=t[r].venue,-1===s?(o.concerts=[],o.concerts.push(t[r]),a.push(o),t[r].venueIndex=n.indexOf(o)):(t[r].venueIndex=s,a[s].concerts.push(t[r]));return a},t.storeLocation=function(e,t,n){localStorage&&(localStorage.setItem("lastAddress",e),localStorage.setItem("latitude",t),localStorage.setItem("longitude",n))},t}),define("settings",[],function(){var e,t,n,a;return localStorage&&localStorage.lastAddress&&localStorage.latitude&&localStorage.longitude?(n=Number(localStorage.latitude),a=Number(localStorage.longitude),e=localStorage.lastAddress,t={latitude:n,longitude:a}):(e="Milwaukee, WI",t={latitude:43.07772111168133,longitude:-88.10023715}),{initAddress:e,initLatlng:t}}),define("async",[],function(){function e(e){var t,n;t=document.createElement("script"),t.type="text/javascript",t.async=!0,t.src=e,n=document.getElementsByTagName("script")[0],n.parentNode.insertBefore(t,n)}function t(e,t){var n=/!(.+)/,s=e.replace(n,""),o=n.test(e)?e.replace(/.+!/,""):a;return s+=s.indexOf("?")<0?"?":"&",s+o+"="+t}function n(){return s+=1,"__async_req_"+s+"__"}var a="callback",s=0;return{load:function(a,s,o,r){if(r.isBuild)o(null);else{var i=n();window[i]=o,e(t(s.toUrl(a),i))}}}}),define("google",["async!https://maps.googleapis.com/maps/api/js?key=AIzaSyA8B9NC0lW-vqhQzWmVp8XwEMFbyg01blI&libraries=places"],function(){return google}),define("gmap",["settings","jquery","google"],function(e,t){var n=document.getElementsByClassName("map-canvas")[0],a={center:{lat:e.initLatlng.latitude,lng:e.initLatlng.longitude},zoom:13},s=new google.maps.Map(n,a);return setTimeout(function(){s||t(".map-error").append("Google Map could not be loaded")},8e3),s}),define("infoWindow",["google","gmap"],function(e){function t(){var e=document.getElementsByTagName("info-window")[0];return e}function n(){var e=s.window.getContent();e&&document.getElementsByClassName("info-window-container")[0].appendChild(e)}function a(){n(),s.window.setContent(t())}var s={};return s.window=new e.maps.InfoWindow,s.resetContentForNewLocation=function(){s.window.close(),n()},s.window.setContent(t()),e.maps.event.addListener(s.window,"closeclick",a),s}),define("mapMarkers",["google","gmap","infoWindow"],function(e,t,n){var a={};return a.clearMarkers=function(e){e.forEach(function(e){e.setMap(null)})},a.createMarkers=function(a,s){for(var o,r=[],i=a(),u=0;u<i.length;u++){var l=new e.maps.LatLng(i[u].latitude,i[u].longitude);o=new e.maps.Marker({position:l,title:i[u].name,icon:"images/red.png",map:t,venueIndex:u}),e.maps.event.addListener(o,"mouseup",function(){var o=this;s(a()[o.venueIndex]),n.window.open(t,o),o.setAnimation(e.maps.Animation.BOUNCE),setTimeout(function(){o.setAnimation(e.maps.Animation["null"])},700)}),r.push(o)}return r},a}),define("searchUtil",[],function(){function e(e,t){return e=e.toLowerCase(),e.indexOf(t)>-1}function t(t,n,a){for(var s=0;s<t.length;s++)if(e(t[s][a],n))return!0;return null}var n={};return n.searchArtists=function(n,a){if(t(n,a,"name"))return!0;for(var s=0;s<n.length;s++)if(n[s].lastFm&&n[s].lastFm.artist&&(e(n[s].lastFm.artist.bio.content,a)||t(n[s].lastFm.artist.tags.tag,a,"name")))return!0;return null},n.performSearch=function(t,a){for(var s,o=[],r=0;r<a.length;r++)s=a[r],(e(s.venue.name,t)||e(s.venue.city,t)||n.searchArtists(s.artists,t))&&o.push(s);return o},n.resetMarkerIcons=function(e){e.forEach(function(e){e.setIcon("images/red.png")})},n.updateMarkerIcon=function(e,t,n){n.forEach(function(n){-1!==e.indexOf(t[n.venueIndex])?n.setIcon("images/blue.png"):n.setIcon("images/clear.png")})},n}),define("geocode",["settings","utils","infoWindow","google"],function(e,t,n,a){var s={},o=new a.maps.Geocoder;return s.requestGeocode=function(s){var r=setTimeout(function(){self.geocoderStatus("Location coordinates could not be loaded.")},8e3);o.geocode({address:s},function(o,i){if(i===a.maps.GeocoderStatus.OK){clearTimeout(r),self.geocoderStatus(null);var u=o[0].geometry.location.lat(),l=o[0].geometry.location.lng(),c={latitude:u,longitude:l};c!==self.mapCenter()&&(n.resetContentForNewLocation(),self.mapCenter(c),t.storeLocation(s,u,l),e.initLatlng={latitude:u,longitude:l},e.initAddress=s)}else self.geocoderStatus("Geocoder error because: "+i)})},s}),define("app",["jquery","knockout","komapping","utils","settings","gmap","mapMarkers","searchUtil","geocode"],function(e,t,n,a,s,o,r,i,u){t.mapping=n,t.bindingHandlers.googlemap={update:function(e,t){var n=t();o.fitBounds(n.mapBounds)}};var l=function(){var e=this;e.currentAddress=t.observable(s.initAddress),e.mapCenter=t.observable(s.initLatlng),e.concerts=t.observableArray(),e.concertVenues=t.observableArray(),e.searchInput=t.observable(),e.filteredEvents=t.observableArray(),e.filteredVenues=t.observableArray(),e.currentEvent=t.observable(),e.currentVenue=t.observable(),e.currentArtist=t.observable(),e.extraInfoBoolean=t.observable(!0),e.showEventInfo=t.observable(!1),e.showVenueInfo=t.observable(!1),e.showArtistInfo=t.observable(!1),e.showMenu=t.observable(!0),e.listEvents=t.observable(!0),e.listVenues=t.observable(!1),e.searchBarFocus=t.observable(!1),e.geocoderStatus=t.observable(),e.concertsStatus=t.observable(),e.allArtistStatusUpdate=t.observable(null),e.showExtraInfo=t.computed(function(){return(e.showEventInfo()||e.showVenueInfo()||e.showArtistInfo())&&e.extraInfoBoolean()?!0:!1}),e.mapMarkers=t.computed(function(){e.mapMarkers&&e.mapMarkers().length&&r.clearMarkers(e.mapMarkers());var t=r.createMarkers(e.concertVenues,e.currentVenue);return t}),e.mapBounds=t.computed(function(){for(var t=e.mapMarkers(),n=new google.maps.LatLngBounds,a=0;a<t.length;a++)n.extend(t[a].getPosition());return n}),e.searchConcerts=t.computed(function(){var t=e.concerts();if(e.searchInput()){var n=e.searchInput().toLowerCase(),s=i.performSearch(n,t),o=a.buildVenues(s,e.concertVenues());e.filteredEvents(s),e.filteredVenues(o),i.updateMarkerIcon(e.filteredVenues(),e.concertVenues(),e.mapMarkers())}else e.filteredEvents(e.concerts()),e.filteredVenues(e.concertVenues()),i.resetMarkerIcons(e.mapMarkers())}),e.selectEvent=function(n){e.selectMarker(n.venueIndex),e.currentEvent(t.mapping.fromJS(n)),e.showEventInfo(!0),e.showVenueInfo(!1),e.showArtistInfo(!1)},e.selectVenue=function(t){var n=t||e.concertVenues()[e.currentEvent().venueIndex()];e.selectMarker(e.concertVenues.indexOf(n)),e.showVenueInfo(!0),e.showEventInfo(!1),e.showArtistInfo(!1)},e.selectArtist=function(t){e.currentArtist(t),e.showArtistInfo(!0),e.showEventInfo(!1),e.showVenueInfo(!1)},e.closeExtraInfo=function(){e.showEventInfo(!1),e.showVenueInfo(!1),e.showArtistInfo(!1)},e.selectMarker=function(t){google.maps.event.trigger(e.mapMarkers()[t],"mouseup"),o.panTo(e.mapMarkers()[t].position)},e.getMapGeocode=t.computed(function(){s.initAddress!==e.currentAddress()&&(e.geocoderStatus("Setting map location..."),u.requestGeocode(e.currentAddress()))})};return l}),define("registerKoComponents",["knockout"],function(e){e.components.register("concerts-list",{require:"koConcertsList"}),e.components.register("current-artist",{require:"koCurrentArtist"}),e.components.register("current-event",{require:"koCurrentEvent"}),e.components.register("current-venue",{require:"koCurrentVenue"}),e.components.register("info-list-toggle",{require:"koInfoListToggle"}),e.components.register("menu-toggle",{require:"koMenuToggle"}),e.components.register("request-all-lastfm",{require:"koRequestAllLastFm"}),e.components.register("venues-list",{require:"koVenuesList"}),e.components.register("status-messages",{require:"koStatusMessages"}),e.components.register("info-window",{require:"koInfoWindow"})}),requirejs.config({baseUrl:"js",paths:{jquery:["https://ajax.googleapis.com/ajax/libs/jquery/2.2.4/jquery.min","./libraries/jquery-2.1.3.min"],knockout:["http://ajax.aspnetcdn.com/ajax/knockout/knockout-3.3.0","./libraries/knockout-3.3.0"],komapping:["https://cdnjs.cloudflare.com/ajax/libs/knockout.mapping/2.4.1/knockout.mapping.min","./libraries/knockout.mapping-latest"],async:"libraries/async",google:"apis/google",text:"libraries/text",app:"app",registerKoComponents:"kocomponents/register-kocomponents",searchUtil:"search-util",settings:"settings",utils:"utils",bandsInTown:"apis/bands-in-town",geocode:"apis/google-geocode",gmap:"apis/gmap",infoWindow:"apis/info-window",mapMarkers:"apis/map-markers",fourSquare:"apis/four-square",googlePlaces:"apis/google-places",venueApiUtils:"apis/venue-api-utils",lastFm:"apis/last-fm",youtube:"apis/youtube",koConcertsList:"kocomponents/concerts-list",koCurrentArtist:"kocomponents/current-artist",koCurrentEvent:"kocomponents/current-event",koCurrentVenue:"kocomponents/current-venue",koInfoListToggle:"kocomponents/info-list-toggle",koMenuToggle:"kocomponents/menu-toggle",koRequestAllLastFm:"kocomponents/request-all-lastfm",koVenuesList:"kocomponents/venues-list",koStatusMessages:"kocomponents/status-messages",koInfoWindow:"kocomponents/info-window",concertsListTemplate:"kotemplates/concerts-list-template",currentArtistTemplate:"kotemplates/current-artist-template",currentEventTemplate:"kotemplates/current-event-template",currentVenueTemplate:"kotemplates/current-venue-template",infoListToggleTemplate:"kotemplates/info-list-toggle-template",menuToggleTemplate:"kotemplates/menu-toggle-template",requestAllLastFmTemplate:"kotemplates/request-all-lastfm-template",venuesListTemplate:"kotemplates/venues-list-template"},shim:{komapping:{deps:["knockout"],exports:["komapping"]}}}),require(["knockout","app","registerKoComponents"],function(e,t){e.applyBindings(t)}),define("init",function(){}),define("bandsInTown",["jquery"],function(e){function t(e){return"available"===e?!0:!1}function n(e){var t;return e>1?(e-=1,t="& "+e+" more act",e>1&&(t+="s")):t=null,t}function a(e){e=new Date(Date.parse(e));var t=e.toDateString();return{day:t.substring(0,3),date:t.substring(4,10),year:e.getFullYear(),time:e.toUTCString().substring(17,22)}}function s(e){for(var s,o=0;o<e.length;o++)e[o].tickets_available=t(e[o].ticket_status),s=e[o].artists.length,e[o].subtitle=n(s),e[o].timeInfo=a(e[o].datetime)}var o={};return o.makeRequestURL=function(e,t){var n="http://api.bandsintown.com/events/search.json?api_version=2.0&app_id=google-map-mashup&location="+e+","+t+"&per_page=100&format=json";return n},o.requestSettings={dataType:"jsonp",crossDomain:"true",timeout:11e3,success:function(e){e?(self.concertsStatus(null),s(e),self.concerts(e)):self.concertsStatus(e.message)},error:function(){self.concertsStatus("Concert data could not be loaded. Please try again.")}},o}),define("text",["module"],function(e){"use strict";function t(e,t){return void 0===e||""===e?t:e}function n(e,n,a,s){if(n===s)return!0;if(e===a){if("http"===e)return t(n,"80")===t(s,"80");if("https"===e)return t(n,"443")===t(s,"443")}return!1}var a,s,o,r,i,u=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],l=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,c=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,d="undefined"!=typeof location&&location.href,p=d&&location.protocol&&location.protocol.replace(/\:/,""),f=d&&location.hostname,m=d&&(location.port||void 0),g={},v=e.config&&e.config()||{};return a={version:"2.0.15",strip:function(e){if(e){e=e.replace(l,"");var t=e.match(c);t&&(e=t[1])}else e="";return e},jsEscape:function(e){return e.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r").replace(/[\u2028]/g,"\\u2028").replace(/[\u2029]/g,"\\u2029")},createXhr:v.createXhr||function(){var e,t,n;if("undefined"!=typeof XMLHttpRequest)return new XMLHttpRequest;if("undefined"!=typeof ActiveXObject)for(t=0;3>t;t+=1){n=u[t];try{e=new ActiveXObject(n)}catch(a){}if(e){u=[n];break}}return e},parseName:function(e){var t,n,a,s=!1,o=e.lastIndexOf("."),r=0===e.indexOf("./")||0===e.indexOf("../");return-1!==o&&(!r||o>1)?(t=e.substring(0,o),n=e.substring(o+1)):t=e,a=n||t,o=a.indexOf("!"),-1!==o&&(s="strip"===a.substring(o+1),a=a.substring(0,o),n?n=a:t=a),{moduleName:t,ext:n,strip:s}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(e,t,s,o){var r,i,u,l=a.xdRegExp.exec(e);return l?(r=l[2],i=l[3],i=i.split(":"),u=i[1],i=i[0],(!r||r===t)&&(!i||i.toLowerCase()===s.toLowerCase())&&(!u&&!i||n(r,u,t,o))):!0},finishLoad:function(e,t,n,s){n=t?a.strip(n):n,v.isBuild&&(g[e]=n),s(n)},load:function(e,t,n,s){if(s&&s.isBuild&&!s.inlineText)return void n();v.isBuild=s&&s.isBuild;var o=a.parseName(e),r=o.moduleName+(o.ext?"."+o.ext:""),i=t.toUrl(r),u=v.useXhr||a.useXhr;return 0===i.indexOf("empty:")?void n():void(!d||u(i,p,f,m)?a.get(i,function(t){a.finishLoad(e,o.strip,t,n)},function(e){n.error&&n.error(e)}):t([r],function(e){a.finishLoad(o.moduleName+"."+o.ext,o.strip,e,n)}))},write:function(e,t,n,s){if(g.hasOwnProperty(t)){var o=a.jsEscape(g[t]);n.asModule(e+"!"+t,"define(function () { return '"+o+"';});\n")}},writeFile:function(e,t,n,s,o){var r=a.parseName(t),i=r.ext?"."+r.ext:"",u=r.moduleName+i,l=n.toUrl(r.moduleName+i)+".js";a.load(u,n,function(t){var n=function(e){return s(l,e)};n.asModule=function(e,t){return s.asModule(e,l,t)},a.write(e,u,n,o)},o)}},"node"===v.env||!v.env&&"undefined"!=typeof process&&process.versions&&process.versions.node&&!process.versions["node-webkit"]&&!process.versions["atom-shell"]?(s=require.nodeRequire("fs"),a.get=function(e,t,n){try{var a=s.readFileSync(e,"utf8");"\ufeff"===a[0]&&(a=a.substring(1)),t(a)}catch(o){n&&n(o)}}):"xhr"===v.env||!v.env&&a.createXhr()?a.get=function(e,t,n,s){var o,r=a.createXhr();if(r.open("GET",e,!0),s)for(o in s)s.hasOwnProperty(o)&&r.setRequestHeader(o.toLowerCase(),s[o]);v.onXhr&&v.onXhr(r,e),r.onreadystatechange=function(a){var s,o;4===r.readyState&&(s=r.status||0,s>399&&600>s?(o=new Error(e+" HTTP status: "+s),o.xhr=r,n&&n(o)):t(r.responseText),v.onXhrComplete&&v.onXhrComplete(r,e))},r.send(null)}:"rhino"===v.env||!v.env&&"undefined"!=typeof Packages&&"undefined"!=typeof java?a.get=function(e,t){var n,a,s="utf-8",o=new java.io.File(e),r=java.lang.System.getProperty("line.separator"),i=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(o),s)),u="";try{for(n=new java.lang.StringBuffer,a=i.readLine(),a&&a.length()&&65279===a.charAt(0)&&(a=a.substring(1)),null!==a&&n.append(a);null!==(a=i.readLine());)n.append(r),n.append(a);u=String(n.toString())}finally{i.close()}t(u)}:("xpconnect"===v.env||!v.env&&"undefined"!=typeof Components&&Components.classes&&Components.interfaces)&&(o=Components.classes,r=Components.interfaces,Components.utils["import"]("resource://gre/modules/FileUtils.jsm"),i="@mozilla.org/windows-registry-key;1"in o,a.get=function(e,t){var n,a,s,u={};i&&(e=e.replace(/\//g,"\\")),s=new FileUtils.File(e);try{n=o["@mozilla.org/network/file-input-stream;1"].createInstance(r.nsIFileInputStream),n.init(s,1,0,!1),a=o["@mozilla.org/intl/converter-input-stream;1"].createInstance(r.nsIConverterInputStream),a.init(n,"utf-8",n.available(),r.nsIConverterInputStream.DEFAULT_REPLACEMENT_CHARACTER),a.readString(n.available(),u),a.close(),n.close(),t(u.value)}catch(l){throw new Error((s&&s.path||"")+": "+l)}}),a}),define("text!../templates/concerts-list.html",[],function(){return'<ul data-bind="visible: listEvents(), foreach: filteredEvents">\n    <li class="clickable" data-bind="click: selectEvent">\n        <hr>\n            <h4>\n                <span data-bind="text: artists[0].name"></span>\n                <span class="subtitle" data-bind="text: subtitle"></span>\n            </h4>\n            <span data-bind="text: timeInfo.day"></span>\n            <span data-bind="text: timeInfo.date"></span>\n        </p>\n        <p class="italic" data-bind="text: venue.name"></p>\n    </li>\n</ul>\n'}),define("concertsListTemplate",["text!../templates/concerts-list.html"],function(e){return e}),define("koConcertsList",["jquery","knockout","bandsInTown","concertsListTemplate"],function(e,t,n,a){var s=function(a){var s=this;s.mapCenter=a.mapCenter,s.concerts=a.concerts,s.concertsStatus=a.concertsStatus,s.getConcerts=t.computed(function(){var t=s.mapCenter().latitude,a=s.mapCenter().longitude,o=n.makeRequestURL(t,a),r=n.requestSettings;s.concertsStatus("Loading Concert Data..."),e.ajax(o,r)})};return{viewModel:s,template:a}}),define("lastFm",["jquery","knockout"],function(e,t){function n(e){return e.mbid?"mbid="+e.mbid:"artist="+e.name}function a(e){var a=n(t.mapping.toJS(e)),s="http://ws.audioscrobbler.com/2.0/?method=artist.getinfo&api_key=d824cbbb7759624aa8b3621a627b70b8&format=json&"+a;return s}function s(e,t,n){n.error?self.concerts()[e].artists[t].lastFm.status=u:(self.concerts()[e].artists[t].lastFm=n,self.concerts()[e].artists[t].lastFm.status=null)}var o={},r="Sorry, additional information from Last.fm could not be ",i=r+"loaded.",u=r+"found.";return o.requestArtistInfo=function(n){var s=a(n),o={success:function(e){e.error?(n.lastFm.status=u,self.currentArtist(t.mapping.fromJS(n))):(n.lastFm=e,n.lastFm.status=null,self.currentArtist(t.mapping.fromJS(n)))},error:function(e){n.lastFm.status=i,self.currentArtist(t.mapping.fromJS(n))},timeout:11e3};e.ajax(s,o)},o.requestAllArtistInfo=function(t){for(var n,o,r=0;r<self.concerts().length;r++)for(var u=0;u<self.concerts()[r].artists.length;u++)o=a(self.concerts()[r].artists[u]),t(t()+1),function(a,r){n={success:function(e,t){s(a,r,e,t)},error:function(){self.concerts()[a].artists[r].lastFm.status=i},complete:function(e,n){t(t()-1),console.log(n)},timeout:11e3},self.concerts()[a].artists[r].lastFm={},e.ajax(o,n)}(r,u)},o}),define("youtube",["jquery","knockout"],function(e,t){function n(e){return e=e.replace(/\s+/g,"+")}function a(e){for(var t,n,a=[],s="https://www.youtube.com/",o=0;o<e.length;o++)n=e[o].snippet.title,e[o].id.videoId?t="watch?v="+e[o].id.videoId:e[o].id.channelId&&(t="channel/"+e[o].id.channelId,n+=" (channel)"),a.push({url:s+t,title:n});return a}var s={};return s.requestArtistVideos=function(s){var o=n(s.name()),r="https://www.googleapis.com/youtube/v3/search?part=snippet&q="+o+"&key=AIzaSyA8B9NC0lW-vqhQzWmVp8XwEMFbyg01blI",i={success:function(e){var n=a(e.items);s.youtube=n,s.youtube.status=null,self.currentArtist(t.mapping.fromJS(s))},error:function(){s.youtube.status="Youtube search results could not be loaded.",self.currentArtist(t.mapping.fromJS(s))},timeout:8e3};e.ajax(r,i)},s}),define("text!../templates/current-artist.html",[],function(){return'<div data-bind="visible: showArtistInfo(), with: currentArtist">\n    <a class="highlight clickable" data-bind="click: function() {$parent.backToEvent(currentEvent())}">back to event page</a>\n    <h3 data-bind="text: name"></h3>\n    <!-- ko if: $data.lastFm -->\n    <p data-bind="text: lastFm.status"></p>\n    <div data-bind="if: lastFm.artist">\n        <ul class="tags" data-bind="foreach: lastFm.artist.tags.tag">\n            <li class="highlight clickable" data-bind="text: name, click: function(){searchInput($data.name())}"></li>\n        </ul>\n        <h4>Bio</h4>\n        <p data-bind="html: lastFm.artist.bio.summary"></p>\n    </div>\n    <!-- /ko -->\n    <p><a data-bind="attr : { href: url }"><span data-bind="text: name"></span>\'s Bands in Town Page</a></p>\n    <h4>Youtube Search Results for "<span data-bind="text: name"></span>"</h4>\n\n    <!-- ko if: $data.youtube -->\n    <p data-bind="text: youtube.status"></p>\n    <ul data-bind="foreach: $data.youtube">\n        <li class="youtube-link">\n            <a data-bind="text: title, attr : { href: url }"></a>\n        </li>\n    </ul>\n    <!-- /ko -->\n\n</div>\n'}),define("currentArtistTemplate",["text!../templates/current-artist.html"],function(e){return e}),define("koCurrentArtist",["knockout","lastFm","youtube","currentArtistTemplate"],function(e,t,n,a){var s=function(a){var s=this;s.currentArtist=a.currentArtist,s.selectEvent=a.selectEvent,s.getArtistExtras=e.computed(function(){var e=s.currentArtist();e&&!e.lastFm&&(e.lastFm={},e.lastFm.status="Loading detailed artist info...",t.requestArtistInfo(e)),e&&!e.youtube&&(e.youtube={},e.youtube.status="Loading Youtube search results...",n.requestArtistVideos(e))}),s.backToEvent=function(t){s.selectEvent(e.mapping.toJS(t))}};return{viewModel:s,template:a}}),define("text!../templates/current-event.html",[],function(){return'<div data-bind="visible: showEventInfo(), with: currentEvent">\n    <div>\n        <h4>\n            <span data-bind="text: artists()[0].name"></span>\n            <span class="subtitle" data-bind="text: subtitle"></span>\n        </h4>\n        <p class="pale-text">\n            <span data-bind="text: timeInfo.time"></span>\n            <br>\n            <span data-bind="text: timeInfo.day"></span>\n            <span data-bind="text: timeInfo.date"></span>\n            <br>\n            <span data-bind="text: timeInfo.year"></span>\n        </p>\n    </div>\n    <h4>Artists</h4>\n    <hr>\n    <ul data-bind="foreach: artists">\n        <li>\n            <a class="highlight clickable" data-bind="text: name, click: function() { selectArtist($data); }"></a>\n            <div data-bind="if: $data.lastFm">\n                <!-- ko if: lastFm.artist -->\n                    <ul class="tags" data-bind="foreach: lastFm.artist.tags.tag">\n                        <li class="highlight clickable" data-bind="text: name, click: function() { searchInput(this.name()) }"></li>\n                    </ul>\n                    <span class="italic" data-bind="if: !lastFm.artist.tags.tag().length">no genre info</span>\n                <!-- /ko -->\n                <span class="italic" data-bind="if: $data.lastFm.status">no additional info</span>\n            </div>\n        </li>\n        <br>\n    </ul>\n    <h4>\n        <span>Venue</span>\n        <a class="highlight clickable subtitle" data-bind="text: venue.name, click: function() { selectVenue(); }"></a>\n    </h4>\n    <a data-bind="attr: { href: url }">Bands in Town Event Page</a>\n    <br>\n    <p data-bind="if: tickets_available"><a data-bind="attr: { href: ticket_url }">Get Tickets</a></p>\n</div>'}),define("currentEventTemplate",["text!../templates/current-event.html"],function(e){return e}),define("koCurrentEvent",["knockout","currentEventTemplate"],function(e,t){return{template:t}}),define("venueApiUtils",[],function(){function e(e,t){var n,a;return"Four Square"===t?(a=e.location||null,n=a.formattedAddress.join(", ")||null):"Google Places"===t&&(n=e.formatted_address||null),n}function t(e,t){var n,a;return"Four Square"===t?(a=e.contact||null,n=a.formattedPhone||null):"Google Places"===t&&(n=e.formatted_phone_number||null),n}function n(e,t){var n=e.rating||null;return n&&(n=n.toString(),"Four Square"===t?n+=" / 10":"Google Places"===t&&(n+=" / 5")),n}function a(e,t){var n,a;return"Four Square"===t?(n=e.categories||null,a=n.map(function(e){return e.shortName})):"Google Places"===t&&(a=e.types||null),a}function s(e,t){var n;return"Four Square"===t?n=e.url||null:"Google Places"===t&&(n=e.website||null),n}function o(e,t){var n;return"Four Square"===t?n=e.url||null:"Google Places"===t&&(n=e.url||null),n}var r={};return r.parseResults=function(r,i){return{formattedAddress:e(r,i),formattedPhone:t(r,i),name:r.name||null,rating:n(r,i),categories:a(r,i),description:r.description||null,officialURL:s(r,i),providerURL:o(r,i),provider:i}},r.checkCurrentVenue=function(e){return self.currentVenue()===self.concertVenues()[e]},r.showNotFoundStatusIfNeeded=function(e,t,n){e||t({status:n,data:null})},r.venueNotFound=function(e,t){e().detailedInfo={data:null,status:t},e(e())},r}),define("fourSquare",["jquery","knockout","venueApiUtils"],function(e,t,n){function a(t,a,s,r){var i=!1,u="https://api.foursquare.com/v2/venues/"+t+"?oauth_token=PV4PYPFODETGIN4BI22F1YN23FER1YPGAKQOBLCODUP251GX&v=20160105",l={success:function(e){if(i=!0,n.checkCurrentVenue(r)){var t=n.parseResults(e.response.venue,"Four Square");a().detailedInfo={data:t,status:null},a(a())}},complete:function(){n.showNotFoundStatusIfNeeded(i,s,o.error)},timeout:8e3};e.ajax(u,l)}function s(e){var t=e().latitude,n=e().longitude,a="https://api.foursquare.com/v2/venues/search?client_id=HEC4M2QKHJVGW5L5TPIBLBWBFJBBFSCIFFZDNZSGD2G5UGTI&client_secret=AJKA10FIBJE3CUKUBYYYOGZ0BU2XNGMXNGUA43LAI0PQT3ZD&v=20160105&m=foursquare&ll="+t+","+n+"&query="+e().name+"&intent=match";return a}var o={};return o.error="Four Square data cannot be found. Loading Google Places data instead...",o.search="Loading Four Square data for venue...",o.requestVenueInfo=function(t,r,i){var u=!1,l=s(t),c={success:function(e){e.response.venues.length>0&&(u=!0,a(e.response.venues[0].id,t,r,i))},complete:function(){n.showNotFoundStatusIfNeeded(u,r,o.error)},timeout:8e3};r({status:o.search,data:null}),e.ajax(l,c)},o}),define("googlePlaces",["jquery","gmap","venueApiUtils","google"],function(e,t,n,a){function s(e,s,o,i){var u=new a.maps.places.PlacesService(t);u.getDetails({placeId:e},function(e,t){if(t===a.maps.places.PlacesServiceStatus.OK&&n.checkCurrentVenue(i)){var o=n.parseResults(e,"Google Places");s().detailedInfo={data:o,status:null},s(s())}else n.venueNotFound(s,r.error)})}function o(e){var t=new a.maps.LatLng(e().latitude,e().longitude);return{location:t,query:e().name,radius:"1"}}var r={};return r.error="Sorry, detailed venue information could not be loaded.",r.requestVenueInfo=function(e,i,u){var l=new a.maps.places.PlacesService(t),c=o(e);l.textSearch(c,function(t,o){o===a.maps.places.PlacesServiceStatus.OK?s(t[0].place_id,e,i,u):n.venueNotFound(e,r.error)})},r}),define("text!../templates/current-venue.html",[],function(){return'<div data-bind="visible: showVenueInfo(), with: currentVenue">\n    <h3 data-bind="text: name"></h3>\n    <p class="pale-text">\n        <span data-bind="text: city"></span>,\n        <span data-bind="text: region"></span>\n    </p>\n\n    <h4>Upcoming Events</h4>\n    <ul data-bind="foreach: concerts">\n        <li>\n            <a class="highlight clickable" data-bind="text: artists[0].name, click: self.selectEvent"></a>\n            <span class="subtitle" data-bind="text: subtitle"></span>\n            -\n            <span class="pale-text" data-bind="text: timeInfo.date"></span>\n        </li>\n        <br>\n    </ul>\n    <div data-bind="with: $parent.currentVenueDetails">\n        <p data-bind="text: status"></p>\n    </div>\n    <div data-bind="with: $parent.currentVenueDetails().data">\n        <hr>\n        <p class="italic">\n            <span data-bind="text: provider"></span>\n            <span class="italic">info for:</span>\n        </p>\n        <p>\n            <span data-bind="text: name"></span>\n        </p>\n        <p data-bind="if: $data.rating">\n            <span class="pale-text">Rating </span>\n            <span class="italic" data-bind="text: $data.rating"></span>\n        </p>\n        <ul class="tags" data-bind="foreach: categories">\n            <li data-bind="text: $data"></li>\n        </ul>\n        <div data-bind="if: $data.description">\n            <p class="italic">Description</p>\n            <p data-bind="text: $data.description"></p>\n        </div>\n        <hr>\n        <p data-bind="if: $data.officialURL">\n            <a data-bind="attr: { href: officialURL }">\n                <span class="italic" data-bind="text: name"></span>\n                <span>\'s Official Site</span>\n            </a>\n        </p>\n        <p data-bind="if: $data.providerURL">\n            <a data-bind="attr: { href: providerURL }">\n                <span data-bind="text: provider"></span><span>\'s </span>\n                <span class="italic" data-bind="text: name"></span>\n                <span> Page</span>\n            </a>\n        </p>\n    </div>\n\n    <p>\n        <a data-bind="attr: { href: url }">\n            <span>Bands in Town\'s </span>\n            <span class="italic" data-bind="text: name"></span>\n            <span> Page</span>\n        </a>\n    </p>\n</div>\n'}),define("currentVenueTemplate",["text!../templates/current-venue.html"],function(e){return e}),define("koCurrentVenue",["knockout","fourSquare","googlePlaces","currentVenueTemplate"],function(e,t,n,a){var s=function(a){var s=this;s.currentVenue=a.currentVenue,s.concertVenues=a.concertVenues,s.currentVenueDetails=e.observable({data:null,status:null}),s.loadDetailedVenueInfo=e.computed(function(){var e=s.currentVenue,a=s.currentVenueDetails,o=s.concertVenues().indexOf(e());e()&&e().detailedInfo?a(e().detailedInfo):e()&&!e().detailedInfo&&a().status===t.error?n.requestVenueInfo(e,a,o):e()&&!e().detailedInfo&&t.requestVenueInfo(e,a,o)})};return{viewModel:s,template:a}}),define("text!../templates/info-list-toggle.html",[],function(){return'<div class="list-toggle menu-interface" data-bind="css: { open: showMenu() }">\n    <button class="list-button clickable" data-bind="css: { pressed: listEvents() }, click: function () { showEvents(); }">EVENTS</button><button class="list-button clickable" data-bind="css: { pressed: listVenues() }, click: function () { showVenues(); }">VENUES</button>\n    <button class="info-button clickable" data-bind="css: { pressed: extraInfoBoolean() }, click: toggleExtraInfo">SHOW INFO POP-UP</button>\n</div>'}),define("infoListToggleTemplate",["text!../templates/info-list-toggle.html"],function(e){return e}),define("koInfoListToggle",["knockout","infoListToggleTemplate"],function(e,t){var n=function(e){var t=this;t.listEvents=e.listEvents,t.listVenues=e.listVenues,t.extraInfoBoolean=e.extraInfoBoolean,t.showEventInfo=e.showEventInfo,t.showVenueInfo=e.showVenueInfo,t.showArtistInfo=e.showArtistInfo,t.showEvents=function(){t.listEvents(!0),t.listVenues(!1)},t.showVenues=function(){t.listEvents(!1),t.listVenues(!0)},t.toggleExtraInfo=function(){t.extraInfoBoolean()?t.extraInfoBoolean(!1):(t.showEventInfo(!1),t.showVenueInfo(!1),t.showArtistInfo(!1),t.extraInfoBoolean(!0))}};return{viewModel:n,template:t}}),define("text!../templates/menu-toggle.html",[],function(){return'<a class="menu-toggle clickable" data-bind="click: function() { toggleMenu() }, css: { open: showMenu() }">\n  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">\n    <path d="M2 6h20v3H2zm0 5h20v3H2zm0 5h20v3H2z"/>\n  </svg>\n</a>'}),define("menuToggleTemplate",["text!../templates/menu-toggle.html"],function(e){return e}),define("koMenuToggle",["knockout","menuToggleTemplate"],function(e,t){var n=function(e){var t=this;t.showMenu=e.showMenu,t.toggleMenu=function(){t.showMenu()?t.showMenu(!1):t.showMenu(!0)}};return{viewModel:n,template:t}}),define("text!../templates/request-all-lastfm.html",[],function(){return'<!-- ko if: displayDialog() -->\n<!-- ko template: { name: \'request-info\' } --><!-- /ko -->\n<script type="text/html" id="request-info">\n    <div class="request-artist-info">\n        <h4>Want better search results?</h4>\n        <p>If you choose to request info about each artist from Last.fm, you\'ll be able to search events by detailed info about the artists, such as genre.</p>\n        <p>Right now you can only search events by artists\' names and venues\' names and addresses.</p>\n        <p> Note: Last.fm info usually loads quickly, but may be slow depending on Last.fm\'s servers</p>\n        <div>\n            <button class="clickable" data-bind="click: function() { submitRequest(true); dontAskAgain(true);}">Yes</button><button class="clickable" data-bind="click: function() { manualToggle(false); }">No</button><button class="clickable" data-bind="click: function() { dontAskAgain(true); }">Don\'t Ask Again</button>\n        </div>\n    </div>\n</script>\n<!-- /ko -->'}),define("requestAllLastFmTemplate",["text!../templates/request-all-lastfm.html"],function(e){return e}),define("koRequestAllLastFm",["knockout","lastFm","requestAllLastFmTemplate"],function(e,t,n){var a=function(n){var a=this;a.searchBarFocus=n.searchBarFocus,a.allArtistStatusUpdate=n.allArtistStatusUpdate,a.artistCount=e.observable(0),
a.manualToggle=e.observable(!1),a.persistentDisplay=e.computed(function(){a.searchBarFocus()&&a.manualToggle(!0)}),a.dontAskAgain=e.observable(!1),a.displayDialog=e.computed(function(){return a.dontAskAgain()?!1:a.searchBarFocus()||a.manualToggle()?!0:!1}),a.submitRequest=e.observable(!1),a.getAllArtistInfo=e.computed(function(){a.submitRequest()&&(a.submitRequest(!1),t.requestAllArtistInfo(a.artistCount))}),a.updateStatus=e.computed(function(){a.artistCount()>0?a.allArtistStatusUpdate("Searching for Artist Info..."):a.allArtistStatusUpdate(null)})};return{viewModel:a,template:n}}),define("text!../templates/venues-list.html",[],function(){return'<ul data-bind="visible: listVenues(), foreach: filteredVenues">\n    <li class="clickable" data-bind="click: selectVenue">\n        <hr>\n        <h4 data-bind="text: name"></h4>\n        <p class="pale-text">\n            <span data-bind="text: city"></span>,\n            <span data-bind="text: region"></span>\n        </p>\n        <p class="italic">\n            <span data-bind="text: concerts.length"></span>\n            <span data-bind="if: concerts.length > 1"> events</span>\n            <span data-bind="if: concerts.length == 1"> event</span>\n        </p>\n    </li>\n</ul>'}),define("venuesListTemplate",["text!../templates/venues-list.html"],function(e){return e}),define("koVenuesList",["knockout","utils","venuesListTemplate"],function(e,t,n){var a=function(n){var a=this;a.concerts=n.concerts,a.concertVenues=n.concertVenues,a.buildAllVenues=e.computed(function(){var e=a.concerts();a.concertVenues(t.buildVenues(e))})};return{viewModel:a,template:n}}),define("text!../templates/status-messages.html",[],function(){return'<p class="map-error"></p>\n<p data-bind="text: concertsStatus"></p>\n<p data-bind="text: geocoderStatus"></p>\n<p data-bind="text: allArtistStatusUpdate"></p>\n<p data-bind="if: searchInput">Search Results for: "<span data-bind="text: searchInput"></span>"</p>\n<p data-bind="visible: !filteredEvents().length && searchInput">no results</p>'}),define("koStatusMessages",["text!../templates/status-messages.html"],function(e){return{template:e}}),define("text!../templates/info-window.html",[],function(){return'<div class="info-content" data-bind="if: currentVenue">\n    <div data-bind="with: currentVenue">\n        <h2 class="window-header clickable" data-bind="text: name, click: selectVenue;"></h2>\n        <ul data-bind="foreach: concerts">\n            <li class="clickable" data-bind="click: selectEvent">\n                <hr>\n                <h4>\n                    <span data-bind="text: artists[0].name"></span> \n                    <span class="subtitle" data-bind="text: subtitle"></span>\n                </h4>\n\n                <p class="window-event-date pale-text">\n                    <span data-bind="text: timeInfo.day"></span>, \n                    <span data-bind="text: timeInfo.date"></span>\n                </p>\n            </li>\n        </ul>\n    </div>\n</div>'}),define("koInfoWindow",["text!../templates/info-window.html"],function(e){return{template:e}});