<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width,initial-scale=1">
        <link href="css/style.css" rel="stylesheet" type="text/css"></link>
        <title>Concert Map</title>

        <script type='text/javascript' src="http://maps.google.com/maps/api/js?sensor=false&.js"></script>


    </head>

    <body>
        <div id="map-canvas" data-bind="googlemap: { mapCenter: mapCenter() }, click: function(){closeSmallMenu()}"></div>
        <a id="menu-toggle" data-bind="click: function() { openSmallMenu(); toggleLargeMenu() }">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M2 6h20v3H2zm0 5h20v3H2zm0 5h20v3H2z"/>
          </svg>
        </a>
        <!-- TODO remane mobileOpen to conform with naming conventions (but knockout doesn't like dashes) -->
        <div id="event-search" class="mobile-menu" data-bind="css: { small: displaySmallMenu(), large: displayLargeMenu() }">
            <input class="search-box" data-bind="textInput: searchInput" placeholder="search concerts">
        </div>
        <div id="list-toggle" class="mobile-menu" data-bind="css: { small: displaySmallMenu(), large: displayLargeMenu() }">
            <button class="list-button" data-bind="css: { pressed: listEvents() }, click: function () { showEvents(); }">EVENTS</button>
            <button class="list-button" data-bind="css: { pressed: listVenues() }, click: function () { showVenues(); }">VENUES</button>
            <button id="info-button" data-bind="css: { pressed: extraInfoBoolean() }, click: toggleExtraInfo">SHOW INFO POP-UP</button>
        </div>
        <div id="event-list" class="mobile-menu list" data-bind="css: { small: displaySmallMenu(), large: displayLargeMenu() }, visible: listEvents()">
            <span class="no-results" data-bind="visible: !filteredEvents().length">no results</span>
            <ul data-bind="foreach: filteredEvents, click: function(){ closeSmallMenu() }">
                <li data-bind="click: selectEvent">
                    <hr>
                    <h4 data-bind="text: title"></h4>
                    <p data-bind="text: venue.name"></p>
                    <p data-bind="text: startDate"></p>
                </li>
            </ul>
        </div>
        <div id="venue-list" class="mobile-menu list" data-bind="css: { small: displaySmallMenu(), large: displayLargeMenu() }, visible: listVenues()">
            <ul data-bind="foreach: lastFmVenues, click: function() { closeSmallMenu() }">
                <li data-bind="click: selectVenue">
                    <hr>
                    <h4 data-bind="text: name"></h4>
                    <p><span data-bind="text: concerts.length"></span> events</p>
                </li>
            </ul>
        </div>

        <div id="location-search" class="mobile-menu" data-bind="css: { small: displaySmallMenu(), large: displayLargeMenu() }">
            <input class="search-box" data-bind="value: currentAddress">
        </div>

        <div id="extra-info" data-bind="css: { 'open': showExtraInfo() }">
            <a id="close-button" data-bind="click: function() { closeExtraInfo(); }">
                <img class="svg-button" src="images/close.svg" alt="CLOSE">
            </a>
            <div data-bind="visible: showEventInfo(), with: currentEvent">
                <div>
                    <h3 data-bind="text: title"></h3>
                    <p data-bind="text: startDate"></p>
                </div>
                <p>Artists:</p>
                <ul data-bind="foreach: artists.artist">
                    <li>
                        <p data-bind="text: $data, click: function() { selectArtist($data); }"></p>
                    </li>
                </ul>
                <div data-bind="if: tags.tag().length > 0">
                    Tags:
                        <ul data-bind="foreach: tags.tag">
                            <li>
                                <p data-bind="text: $data, click: searchInput"></p>
                            </li>
                        </ul>
                </div>
                <p>Venue: <span data-bind="text: venue.name, click: function() { selectVenue(); }"></span></p>
                <a data-bind="attr: { href: url }">Last FM Event Page</a>
                <a data-bind="if: website, attr: { href: website }">Offical Site</a>
                <p data-bind="if: description">Description: <span data-bind="html: description"></span></p>
            </div>

            <div data-bind="visible: showVenueInfo(), with: currentVenue">
                <h3 data-bind="text: name"></h3>
                <p>Address:
                    <span data-bind="text: location.street"></span>
                    <span data-bind="text: location.city"></span>
                    <span data-bind="text: location.postalcode"></span>
                </p>
                <p>Last FM URL: <a data-bind="attr: { href: url }, text: url"></a></p>
                <p data-bind="if: website">Website: <a data-bind="attr: { href: website }, text: website"></a></p>
                <p>Phone #: <span data-bind="text: phonenumber"></span></p>
                <h4>Upcoming Events:</h4>
                <ul data-bind="foreach: concerts">
                    <li>
                        <p data-bind="text: title, click: self.selectEvent"></p>
                    </li>
                </ul>

                <!-- what else to put here? -->
                <div data-bind="with: currentVenueFourSquare">
                    <h4>4 Square Info:</h4>
                        <a data-bind="attr: { href: canonicalUrl }">4 square page</a>
                        <p data-bind="text: $data.description"></p>
                        <p data-bind="text: rating"></p>
                        <p>Categories</p>
                        <ul data-bind="foreach: categories">
                            <li>
                                <p data-bind="text: shortName"></p>
                            </li>
                        </ul>
                </div>

            </div>

            <div data-bind="visible: showArtistInfo()">
                <h3 data-bind="text: currentArtist()"></h3>
                <div data-bind="with: currentArtistInfo">
                    <p>Tags:</p>
                    <ul data-bind="foreach: tags.tag">
                        <li>
                            <p data-bind="text: name"></p>
                        </li>
                    </ul>
                    <p>Bio</p>
                    <p data-bind="html: bio.summary"></p>
                </div>
                <p>Youtube Search Results:</p>
                <ul data-bind="foreach: currentArtistYoutube">
                    <li>
                        <p><a data-bind="text: snippet.title, attr : { href: url }"></a></p>
                    </li>
                </ul>
            </div>
        </div>

        <script type='text/javascript' src='js/libraries/jquery-2.1.3.min.js'></script>
        <script type='text/javascript' src='js/libraries/knockout-3.3.0.js'></script>
        <script type='text/javascript' src='js/libraries/knockout.mapping-latest.js'></script>
        <script type='text/javascript' src="js/app.js"></script>

    </body>
</html>